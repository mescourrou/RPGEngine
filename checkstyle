#!/bin/bash

dry_run=""

print_usage() {
    echo "$0 [-df]"
    echo "-d : Dry-run : do not modify files"
}

while getopts ':dv' flag; do
  case "${flag}" in
    d) dry_run="--dry-run" ;;
    *) print_usage
       exit 1 ;;
  esac
done

echo "Executing checkstyle:"
if [ -z $dry_run ]; then
    echo "Modify files"
else
    echo "Dry-run"
fi
#Checkstyle
astyle --style=allman \
        --align-pointer=type \
        --indent=spaces=4 \
        --attach-closing-while \
        --indent-modifiers \
        --indent-preproc-define \
        --indent-col1-comments \
        --pad-oper \
        --pad-comma \
        --pad-header \
        --align-reference=type \
        --convert-tabs \
        --close-templates \
        --max-code-length=80 \
	--lineend=linux \
        --recursive src/*.cpp src/*.hpp \
        $dry_run -Q 
#echo "$ret"
#exit $(echo "$ret" | grep -c Format)
